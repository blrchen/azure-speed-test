<div class="page-container ip-region-page py-3">
  <header class="page-intro">
    <h1 class="page-title page-intro__title">Azure IP Ranges By Region</h1>
    <p class="page-intro__description">
      Explore Azure IP ranges across every public region. Filter by geography, scan the latest
      service tags, and jump directly to the ranges that matter for your deployments.
    </p>
    <p class="page-intro__description">
      Need service-specific ranges?
      <a class="link-inline" routerLink="/Information/AzureIpRangesByService">View by service</a>
      instead.
    </p>
  </header>

  <section class="ip-region-controls" aria-label="Filter regions">
    <label class="ip-region-controls__label" for="ip-region-search">Search regions</label>
    <div class="ip-region-controls__input">
      <app-hero-icon name="heroMagnifyingGlass" class="h-4 w-4" aria-hidden="true" />
      <input
        id="ip-region-search"
        type="search"
        [value]="searchTerm()"
        (input)="onSearchInput($event)"
        placeholder="Search by region name, code, or geography"
        autocomplete="off"
      />
      @if (searchTerm()) {
        <button
          type="button"
          class="ip-region-controls__clear"
          (click)="clearSearch()"
          aria-label="Clear search"
        >
          <app-hero-icon name="heroXMark" class="h-4 w-4" aria-hidden="true" />
        </button>
      }
    </div>
    <p class="ip-region-controls__summary">
      Showing {{ filteredRegionCount() }} of {{ totalRegionCount() }} regions
    </p>
  </section>

  @if (!filteredRegionCount()) {
    <section class="ip-region-empty" aria-live="polite">
      <app-hero-icon
        name="heroExclamationCircle"
        class="ip-region-empty__icon h-7 w-7"
        aria-hidden="true"
      />
      <h2>No regions match your search</h2>
      <p>Try a different keyword or reset the filter to explore the full directory.</p>
      <button
        type="button"
        class="app-button app-button--outline-secondary"
        (click)="clearSearch()"
      >
        Reset search
      </button>
    </section>
  } @else {
    @for (group of groupedRegions(); track trackByGroup($index, group)) {
      <section class="ip-region-group">
        <header class="ip-region-group__header">
          <h2 class="ip-region-group__title">{{ group.label }}</h2>
          <span class="ip-region-group__count">{{ group.regions.length }}</span>
        </header>
        <div class="ip-region-group__grid">
          @for (region of group.regions; track trackByRegion($index, region)) {
            <article class="ip-region-card">
              <header class="ip-region-card__header">
                <div>
                  <p class="ip-region-card__name">{{ region.displayName }}</p>
                  <span class="ip-region-card__code">{{ region.regionId }}</span>
                </div>
                <span class="ip-region-card__geography">{{ region.geography }}</span>
              </header>
              <div class="ip-region-card__body">
                <span class="ip-region-card__location">
                  <app-hero-icon name="heroMapPin" class="h-4 w-4" aria-hidden="true" />
                  {{ region.datacenterLocation }}
                </span>
                <span class="ip-region-card__service-tag">{{ region.serviceTagId }}</span>
              </div>
              <footer class="ip-region-card__actions">
                <a
                  class="app-button app-button--outline-secondary app-button--sm"
                  [routerLink]="['/Information/AzureIpRanges', region.serviceTagId]"
                >
                  View IP ranges
                </a>
              </footer>
            </article>
          }
        </div>
      </section>
    }
  }
</div>
