<div class="page-container py-3">
  <header class="page-intro">
    <h1 class="page-title page-intro__title">ChatGPT Email Generator</h1>
    <p class="page-intro__description">
      Instantly generate professional, medium to long-sized emails. Enter your email subject or key
      points below and let our tool craft your message.
    </p>
  </header>
  <form [formGroup]="userContentForm" (submit)="submitForm()" autocomplete="off" class="mb-3">
    <fieldset class="app-form mb-3">
      <label for="userContent" class="app-form__label font-semibold">
        Email Subject or Key Points
      </label>
      <textarea
        class="app-form__control"
        id="userContent"
        formControlName="userContent"
        placeholder="E.g. Requesting project update, congratulating a colleague, following up after meeting..."
        required
        rows="6"
      ></textarea>
      <small class="app-form__note text-slate-500">
        {{ userContentForm.get('userContent')?.value?.length || 0 }}/5000 characters
      </small>
      @if (userContentForm.controls['userContent'].errors?.['maxlength']) {
        <div class="app-alert">
          Character limit exceeded. Please limit your text to 5000 characters.
        </div>
      }
    </fieldset>
    <button
      type="submit"
      class="app-button app-button--primary mr-2"
      [disabled]="userContentForm.invalid || isLoading()"
    >
      Generate Email
    </button>
    <button type="button" class="app-button app-button--outline-secondary" (click)="resetForm()">
      Reset
    </button>
  </form>
  @if (isLoading()) {
    <div class="my-4 flex items-center justify-center">
      <div class="app-spinner mr-2 text-brand" role="status"></div>
      <span class="font-semibold">Processing...</span>
    </div>
  }
  @if (hasResult()) {
    <div class="app-card mb-4">
      <div class="app-card__header flex items-center justify-between">
        <h2 class="text-lg font-semibold text-slate-900">Generated Email Draft</h2>
        <button
          type="button"
          class="app-button app-button--sm"
          [class.app-button--outline-primary]="isCopyIdle()"
          [attr.data-variant]="isCopySuccess() ? 'success' : isCopyError() ? 'danger' : null"
          (click)="copyToClipboard(result() ?? '')"
        >
          @if (isCopyIdle()) {
            <span>Copy</span>
          }
          @if (isCopySuccess()) {
            <span>&#10003; Copied!</span>
          }
          @if (isCopyError()) {
            <span>&#10006; Copy Failed</span>
          }
        </button>
      </div>
      <div class="app-card__body">
        <div class="rounded border bg-slate-100 p-3">
          <p style="white-space: pre-wrap" class="mb-0">{{ result() }}</p>
        </div>
      </div>
    </div>
  }
  @if (errorMessage()) {
    <div class="app-alert">
      {{ errorMessage() }}
    </div>
  }
  <app-assistant-footer></app-assistant-footer>
</div>
